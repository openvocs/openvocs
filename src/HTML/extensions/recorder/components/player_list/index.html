<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Opus Media Player</title>
    <link rel="stylesheet" href="/css/ov_basic.css">
    <style>

        /* Style for each recording entry */
        .recording {
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .recording h3 {
            margin-bottom: 10px;
            font-size: 1.2em;
            color: #333;
        }

        .recording p {
            margin-bottom: 10px;
            color: #666;
        }

        .recording audio {
            width: 100%;
            outline: none;
        }

        /* Optional: Style the audio controls */
        audio::-webkit-media-controls-panel {
            background-color: #333;
        }

        audio::-webkit-media-controls-play-button,
        audio::-webkit-media-controls-current-time-display,
        audio::-webkit-media-controls-time-remaining-display,
        audio::-webkit-media-controls-timeline,
        audio::-webkit-media-controls-volume-slider {
            color: #fff;
        }
    </style>
</head>

<body>
    <h1>Opus Recordings</h1>
    <dialog open>
        <select name="loops">
            <option value="recorded_loop">recorded loop</option>
            <option value="project1_loopA">project1 loopA</option>
            <option value="project1_loopB">project1 loopB</option>
        </select>
        <ov-recorder></ov-recorder>
    </dialog>



    <!-- Include your JavaScript file -->
    <script>
        SIGNALING_REQUEST_TIMEOUT = 10000;
        SIP = true;
    </script>
    <script type="module">
        import ov_Websocket from '/lib/ov_websocket.js';
        import ov_Player_List from './recorder.js';

        let parameter =
        {
            // Replace with actual values or remove if not needed
            // loop: 'general',
            // user: 'tobias',
            from: 0, // Start time (e.g., UNIX timestamp)
            to: 1728395109    // End time
        };

        let request = {
            "event": "get_recording",
            "parameter": {
                "loop": "recorded loop",
                "from": 123456789,
                "to": 987654321
            }
        }

        let uri = 'https://openvocs.net/audio/'

        // read json file response.json dummy test response from local file tree
        // let fake_response = [
        //         {
        //             "id": "0ab8dc7a-be95-12bc-8365-84eb17c7bec9",
        //             "uri": "project1_Bloop_20241010T09-00-00_21fe55fb-300a-44dd-8228-90564aaeaf6d.ogg",
        //             "loop": "recorded_loop",
        //             "start_epoch_secs": 123456789,
        //             "end_epoch_secs": 123456795
        //         },
        //         {
        //             "id": "70acab6b-eb35-88e0-b9e8-be1352b25dbd",
        //             "uri": "project1_loopA_20241016T16_00_00_21fe55fb-2aee-44dd-8228-86564aaeaf6d.ogg",
        //             "loop": "recorded_loop",
        //             "start_epoch_secs": 123456789,
        //             "end_epoch_secs": 123456795
        //         }//,
        //         // {
        //         //     "id": "459126db-6119-8e7d-14a8-1eeea21d91c2",
        //         //     "uri": "example2.opus",
        //         //     "loop": "recorded_loop",
        //         //     "start_epoch_secs": 123456789,
        //         //     "end_epoch_secs": 123456795
        //         // }
        //     ]

        const username = 'tobias';
        const password = '2simple!';

        const socketUrl = 'wss://openvocs.net/vocs';

        let websocket = new ov_Websocket("Test Server", socketUrl);
        websocket.log_outgoing_events = true;
        websocket.log_incoming_events = true;

        // optional um auf disconnected Events zu hÃ¶ren
        websocket.addEventListener("disconnected", () => { });
        await websocket.connect();
        await websocket.login(username, password);
        await websocket.send_event(ov_Websocket.EVENT.AUTHORIZE_ROLE, { role: "developers" });
        let real_result = await websocket.send_event('get_recording', parameter);


        let recorder = document.querySelector('ov-recorder');
        recorder.draw_recordings(real_result, uri);
    </script>
</body>

</html>